<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#1e1e1e">
    <title>Verses - Note-taking App</title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">
    
    <!-- Styles -->
    <link rel="stylesheet" href="/styles/main.css">
    
    <!-- Marked.js for Markdown rendering -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/11.1.1/marked.min.js"></script>
    
    <!-- Web Components -->
    <script type="module" src="/js/components/auth-form.js"></script>
    <script type="module" src="/js/components/notebooks-sidebar.js"></script>
    <script type="module" src="/js/components/notes-list.js"></script>
    <script type="module" src="/js/components/note-editor.js"></script>
    <script type="module" src="/js/components/color-picker.js"></script>
    
    <!-- App Logic -->
    <script type="module" src="/js/api.js"></script>
    <script type="module" src="/js/app.js"></script>
</head>
<body>
    <!-- Auth Screen (shown when not logged in) -->
    <div id="auth-screen" class="auth-screen">
        <div class="auth-container">
            <div class="auth-header">
                <h1>ğŸ“ Verses</h1>
                <p>Servers host verses. Code is poetry.</p>
            </div>
            <auth-form></auth-form>
        </div>
    </div>

    <!-- Main App (shown when logged in) -->
    <div id="app" class="app hidden">
        <!-- Header -->
        <header class="app-header">
            <div class="header-left">
                <h1>ğŸ“ Verses</h1>
            </div>
            <div class="header-right">
                <span id="user-email" class="user-email"></span>
                <button id="logout-btn" class="btn-logout">Logout</button>
            </div>
        </header>

        <!-- Main Content - 3 Columns -->
        <main class="app-main">
            <!-- Column 1: Notebooks Sidebar -->
            <notebooks-sidebar id="notebooks-sidebar"></notebooks-sidebar>

            <!-- Column 2: Notes List -->
            <notes-list id="notes-list"></notes-list>

            <!-- Column 3: Note Editor -->
            <note-editor id="note-editor"></note-editor>
        </main>
    </div>

    <!-- Color Picker Dialog -->
    <color-picker id="color-picker"></color-picker>

    <!-- Register Service Worker in production: https only -->
    <script>
        if ('serviceWorker' in navigator && location.protocol === 'https:') {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(reg => console.log('Service Worker registered'))
                    .catch(err => console.log('Service Worker registration failed:', err));
            });
        }
    </script>
</body>
</html>

